@{
    ViewData["Title"] = "Gestión de Cursos";
    ViewBag.ActiveNav = "courses";
}

<section>
    <h1 class="admin-page-title">Gestión de Cursos</h1>
    <p class="admin-page-subtitle">
        Administra el catálogo de cursos de capacitación de Griver.
    </p>

    <!-- Barra superior: filtros + botones -->
    <div class="admin-section-header">
        <div style="flex:1; max-width:420px;">
            <input class="form-input"
                   placeholder="Buscar cursos..."
                   name="BuscarCursos" />
        </div>
        <div style="display:flex; gap:8px;">
            <button class="btn btn--secondary" type="button" id="btnExportCourses">
                ⬇ Exportar Reportes
            </button>
            <button class="btn btn--primary" type="button" data-open-modal="modalNuevoCurso">
                ＋ Nuevo Curso
            </button>
        </div>
    </div>

    <!-- Chips de filtros (Todos, Activos, Borradores, Archivados) -->
    <div class="filters-bar">
        <button class="filter-chip filter-chip--active" type="button">Todos</button>
        <button class="filter-chip" type="button">Activos</button>
        <button class="filter-chip" type="button">Borradores</button>
        <button class="filter-chip" type="button">Archivados</button>
    </div>

    <!-- Resumen de estadísticas -->
    <div class="metric-grid" style="margin-top:10px;">
        <article class="card metric-card">
            <div class="metric-card__label">
                <span class="metric-card__icon">📚</span>
                <span>Total Cursos</span>
            </div>
            <div class="metric-card__value">@Model.TotalCourses</div>
            <div class="metric-card__delta metric-card__delta--up">
                +@Model.NewCoursesSinceLastMonth desde el mes pasado
            </div>
        </article>
        <article class="card metric-card">
            <div class="metric-card__label">
                <span class="metric-card__icon">✅</span>
                <span>Cursos Activos</span>
            </div>
            <div class="metric-card__value">@Model.ActiveCourses</div>
            <div class="metric-card__delta">
                @Model.ActiveCoursesPercent% del total
            </div>
        </article>
        <article class="card metric-card">
            <div class="metric-card__label">
                <span class="metric-card__icon">👨‍🎓</span>
                <span>Estudiantes Totales</span>
            </div>
            <div class="metric-card__value">@Model.TotalStudents</div>
            <div class="metric-card__delta">
                Across all courses
            </div>
        </article>
        <article class="card metric-card">
            <div class="metric-card__label">
                <span class="metric-card__icon">📈</span>
                <span>Tasa Promedio</span>
            </div>
            <div class="metric-card__value">@Model.AvgCompletionRate%</div>
            <div class="metric-card__delta">
                Completion rate
            </div>
        </article>
    </div>

    <!-- Listado de cursos -->
    <h2 class="admin-section-title" style="margin-top:18px;">
        Cursos (@Model.Courses.Count)
    </h2>

    <div style="display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:16px; margin-top:8px;">
        @foreach (var c in Model.Courses)
        {
            <article class="course-card">
                <div class="course-card__header">
                    <div>
                        <div class="course-card__title">@c.Name</div>
                        <div style="margin-top:4px; display:flex; gap:6px; flex-wrap:wrap;">
                            @foreach (var tag in c.Tags)
                            {
                                <span class="badge badge--green">@tag</span>
                            }
                        </div>
                    </div>
                    <div>
                        <span style="font-size:.8rem; color:#6b7280;">
                            Creado: @c.CreatedAt.ToShortDateString()
                        </span>
                    </div>
                </div>
                <p style="font-size:.82rem; color:#6b7280; margin-bottom:8px;">
                    @c.ShortDescription
                </p>

                <div style="display:flex; gap:12px; font-size:.82rem; color:#6b7280; margin-bottom:6px;">
                    <span>⏱ @c.DurationMinutes min</span>
                    <span>👨‍🎓 @c.StudentsCount estudiantes</span>
                    <span>✅ @c.CompletionRate% completado</span>
                </div>

                <div style="margin-bottom:6px;">
                    <div class="progress-bar">
                        <div class="progress-bar__fill"
                             style="width:@c.CompletionRate%"></div>
                    </div>
                </div>

                <div style="display:flex; justify-content:flex-end; gap:6px; margin-top:6px;">
                    <a href="/Admin/Courses/View/@c.Id" class="btn btn--secondary" style="padding:5px 10px;">Ver</a>
                    <a href="/Admin/Courses/Edit/@c.Id" class="btn btn--secondary" style="padding:5px 10px;">Editar</a>
                    <form method="post" action="/Admin/Courses/Delete/@c.Id">
                        <button type="submit"
                                class="btn btn--danger"
                                style="padding:5px 10px;">
                            🗑
                        </button>
                    </form>
                </div>
            </article>
        }
    </div>
</section>
